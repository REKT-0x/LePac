/* iOS Safari fixes */
html, body, canvas, #mobileControls, .joystick, button {
    touch-action: manipulation !important;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -webkit-tap-highlight-color: rgba(0,0,0,0);
    -webkit-user-modify: none;
}

* { margin:0; padding:0; box-sizing:border-box; }
body { 
    background:#000; color:#fff; font-family:Arial,Helvetica,sans-serif; 
    overflow:hidden; height:100vh; 
    padding-top:env(safe-area-inset-top); padding-bottom:env(safe-area-inset-bottom);
    padding-left:env(safe-area-inset-left); padding-right:env(safe-area-inset-right);
}
.container { text-align:center; padding:10px; max-width:100vw; min-height:100vh; }

h1 { margin-bottom:10px; font-size:clamp(1.4rem, 4vw, 1.8rem); }

.score { 
    display:flex; justify-content:center; align-items:center; gap:20px; 
    margin:10px 0; font-weight:bold; font-size:clamp(1rem, 3vw, 1.1rem);
}
.score span { min-width:60px; }
.player-info { display:flex; align-items:center; gap:10px; }
.avatar {
    border:2px solid #333; border-radius:50%; 
    image-rendering:pixelated; background:#222;
    cursor:pointer;
}

#gameCanvas { 
    image-rendering:pixelated; 
    border:4px solid #111; 
    background:#000; 
    display:block; margin:0 auto;
    max-width:100%; height:auto;
    touch-action:none;
}

.overlay {
    position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
    font-size:clamp(1.5rem, 6vw, 2rem); font-weight:bold; 
    background:rgba(0,0,0,0.9); padding:20px 40px; 
    border-radius:12px; pointer-events:none; text-align:center;
}
.hidden { display:none; }

.controls {
    position:fixed; bottom:env(safe-area-inset-bottom); left:10px; right:10px; 
    display:flex; justify-content:space-between; align-items:center;
    pointer-events:none; opacity:0; transition:opacity 0.3s;
}
.controls.show { opacity:1; pointer-events:all; }

.joystick {
    width:80px; height:80px; 
    background:radial-gradient(circle, rgba(100,100,100,0.3) 0%, rgba(0,0,0,0.5) 70%);
    border:3px solid #444; border-radius:50%; 
    position:relative; margin:0 auto;
}
.knob {
    width:40px; height:40px; 
    background:radial-gradient(circle, #ff0 0%, #dd0 70%);
    border:3px solid #fff; border-radius:50%;
    position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
    transition:0.1s;
}

.action-buttons {
    display:grid; grid-template-columns:1fr 1fr; gap:10px;
}
.action-buttons button {
    width:60px; height:60px; font-size:1.8rem; font-weight:bold;
    background:linear-gradient(145deg, #555, #333); 
    border:3px solid #666; border-radius:12px; color:#fff;
    cursor:pointer; user-select:none;
    font-size:16px;
}
.action-buttons button:active {
    background:linear-gradient(145deg, #777, #555); transform:scale(0.95);
}

@media (orientation: landscape) and (max-height: 500px) {
    .controls { bottom:5px; }
    .joystick { width:70px; height:70px; }
    .knob { width:35px; height:35px; }
    .action-buttons button { width:50px; height:50px; font-size:1.5rem; }
}

@media (min-width: 768px) {
    .controls { display:none; }
}
